<!DOCTYPE html>
<html>
<head>
    <title>GitHub Pages 資料儲存範例</title>
</head>
<body>

    <h1>輸入您的出庫資料</h1>
    <form id="dataForm">
        <label for="Name">出庫人員代號:</label>
        <input type="text" id="Name" required><br><br>

        <label for="Message">器械條碼:</label>
        <textarea id="Message" required></textarea><br><br>
        
        <label for="Message2">出庫填1、歸還填2:</label>
        <textarea id="Message2" required></textarea><br><br>

        <button type="submit">儲存資料到 Google Sheets</button>
    </form>

    <p id="responseMessage"></p>

    <script>
        // *** 將此處替換為您在步驟二中獲得的「網路應用程式網址」 ***
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxWyobf4R0_bqo7rkEMjfggEFcIvhJjqMp8d-7-fS9a0FPEV4AUUO1dNzSKpVe3Ft__/exec';

        document.getElementById('dataForm').addEventListener('submit', function(e) {
            e.preventDefault(); // 阻止表單預設提交行為

            const form = e.target;
            const messageElement = document.getElementById('responseMessage');
            messageElement.textContent = '正在儲存中...';

            // 1. 收集表單數據
            const payload = {
                // 注意：這裡的鍵 (Key) 必須與您的 Google Sheet 第一行標題完全一致
                // 例如：Google Sheet 標題是 "Name"，這裡的 Key 也要是 "Name"
                Name: document.getElementById('Name').value,
                Message: document.getElementById('Message').value
                Messagee: document.getElementById('Messagee').value
                // 'Timestamp' 欄位由 Apps Script 自動生成
            };

            // 2. 發送 POST 請求到 Apps Script API
            fetch(APPS_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // 必須使用 no-cors，因為 Apps Script 不會回傳 CORS 標頭
                cache: 'no-cache',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => {
                // 由於是 no-cors 模式，我們無法檢查 response.ok 或解析 JSON 響應。
                // 只能假設請求已發送，並在 Apps Script 中確認是否成功。
                // 在實際專案中，您應使用更複雜的 CORS 設置或中介服務。
                messageElement.textContent = '資料已發送！請檢查 Google Sheets 確認儲存成功。';
                form.reset();
            })
            .catch(error => {
                // 捕獲網路錯誤
                messageElement.textContent = '發送失敗: ' + error.message;
            });
        });
    </script>

</body>

</html>





